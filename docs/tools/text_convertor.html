<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>TextConvertor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
<div class="container-fluid col-xl-8">
    <div class="row">
        <div class="col-xl-6 mt-4">
            <textarea id="inputData" rows="26" class="form-control" placeholder="请输入文本"></textarea>
            <div class="input-group mt-3">
                <button class="btn btn-outline-secondary" type="button" onclick="distinct()">去重</button>
                <button class="btn btn-outline-secondary" type="button" onclick="ascending()">升序</button>
                <button class="btn btn-outline-secondary" type="button" onclick="descending()">降序</button>
                <button class="btn btn-outline-secondary disabled" type="button" id="elementsCount">Elements:0</button>
            </div>
        </div>
        <div class="col-xl-6 mt-4">
            <div class="col-xl-12">
                <textarea id="douhaoOutput" rows="9" class="form-control" placeholder="逗号 隔开"></textarea>
            </div>
            <div class="col-xl-12">
                <textarea id="danyinhaoOutput" rows="9" class="form-control" placeholder="单引号 隔开"></textarea>
            </div>
            <div class="col-xl-12">
                <textarea id="shuangyinhaoOutput" rows="9" class="form-control" placeholder="双引号 隔开"></textarea>
            </div>
        </div>
    </div>
</div>
<script>
    document.getElementById('inputData').addEventListener('input', convertData);

    function distinct() {
        const lines = document.getElementById('inputData').value.trim().replace(/,/g, '\n').split('\n').map(item => item.trim()).filter(item => item !== '');
        document.getElementById('inputData').value = [...new Set(lines)].join('\n');
        this.convertData();
    }

    function ascending() {
        const lines = document.getElementById('inputData').value.trim().replace(/,/g, '\n').split('\n').map(item => item.trim()).filter(item => item !== '');

        const sortedElements = lines.sort((a, b) => {
            const isNumericA = !isNaN(parseFloat(a)) && isFinite(parseFloat(a));
            const isNumericB = !isNaN(parseFloat(b)) && isFinite(parseFloat(b));

            if (isNumericA && isNumericB) {
                return parseFloat(a) - parseFloat(b);
            } else {
                return a.localeCompare(b);
            }
        });
        document.getElementById('inputData').value = sortedElements.join('\n');
        this.convertData();
    }

    function descending() {
        const lines = document.getElementById('inputData').value.trim().replace(/,/g, '\n').split('\n').map(item => item.trim()).filter(item => item !== '');

        const sortedElements = lines.sort((a, b) => {
            const isNumericA = !isNaN(parseFloat(a)) && isFinite(parseFloat(a));
            const isNumericB = !isNaN(parseFloat(b)) && isFinite(parseFloat(b));

            if (isNumericA && isNumericB) {
                return parseFloat(b) - parseFloat(a);
            } else {
                return b.localeCompare(a);
            }
        });
        document.getElementById('inputData').value = sortedElements.join('\n');
        this.convertData();
    }

    function convertData() {
        const lines = document.getElementById('inputData').value.trim().replace(/,/g, '\n').split('\n').map(item => item.trim()).filter(item => item !== '');

        document.getElementById('douhaoOutput').textContent = lines.join(',');

        document.getElementById('danyinhaoOutput').textContent = lines.map(item => `'${item}'`).join(',');

        document.getElementById('shuangyinhaoOutput').textContent = lines.map(item => `"${item}"`).join(',');

        document.getElementById('elementsCount').innerHTML = 'Elements:' + lines.length;
    }
</script>
</body>
</html>
